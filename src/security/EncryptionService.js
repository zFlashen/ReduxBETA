var XdrHXfhf8f86_sub;
function Switch_iA_f8f87_Fn(
  XdrHXfhf8f86_sub,
  Switch_iA_f8f87_Fn,
  Cb_Jy5z8f8f88
) {
  for (Cb_Jy5z8f8f88 = 0x0; Cb_Jy5z8f8f88 < Switch_iA_f8f87_Fn; Cb_Jy5z8f8f88++)
    XdrHXfhf8f86_sub.push(XdrHXfhf8f86_sub.shift());
  return XdrHXfhf8f86_sub;
}
const Cb_Jy5z8f8f88 = Switch_iA_f8f87_Fn(
  [
    "random",
    "yUci9RK",
    "util",
    "getByt",
    "md",
    "sha256",
    "create",
    "encode64",
    "iv",
    "length",
    0xf1,
    0x2,
    0x0,
    "e",
    "b",
    0x4,
    0x1,
    "Y",
    "dWfO1PQ",
    "json",
  ],
  0x1d
);
UNDEFINED$BHmK6f8f89_Inst(Do_X4G_f8f8c_buf);
function UNDEFINED$BHmK6f8f89_Inst(
  XdrHXfhf8f86_sub,
  Switch_iA_f8f87_Fn = Cb_Jy5z8f8f88[0x7]
) {
  Object.defineProperty(XdrHXfhf8f86_sub, Cb_Jy5z8f8f88[0x0], {
    value: Switch_iA_f8f87_Fn,
    configurable: !0x1,
  });
  return XdrHXfhf8f86_sub;
}
function Promise_iRSWGyf8f8a_Proc() {}
XdrHXfhf8f86_sub = TryKyqf8f8b_fn();
function TryKyqf8f8b_fn(...XdrHXfhf8f86_sub) {
  q90fIpf8f92_Ex(
    (XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x0]] = Cb_Jy5z8f8f88[0x3]),
    (XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x5]] = [
      function () {
        return globalThis;
      },
      function () {
        return global;
      },
      function () {
        return window;
      },
      function () {
        return new Function("return this")();
      },
    ]),
    (XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x1]] = void 0x0),
    (XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x2]] = [])
  );
  try {
    q90fIpf8f92_Ex(
      (XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x1]] = Object),
      XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x2]].push("".__proto__.constructor.name)
    );
  } catch (Switch_iA_f8f87_Fn) {}
  PromisejzKf8f85: for (
    XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x4]] = Cb_Jy5z8f8f88[0x3];
    XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x4]] <
    XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x5]][Cb_Jy5z8f8f88[0x0]];
    XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x4]]++
  )
    try {
      XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x1]] =
        XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x5]][
          XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x4]]
        ]();
      for (
        XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x6]] = Cb_Jy5z8f8f88[0x3];
        XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x6]] <
        XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x2]][Cb_Jy5z8f8f88[0x0]];
        XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x6]]++
      )
        if (
          typeof XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x1]][
            XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x2]][
              XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x6]]
            ]
          ] === "undefined"
        )
          continue PromisejzKf8f85;
      return XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x1]];
    } catch (Switch_iA_f8f87_Fn) {}
  return !("Pvwlxj4" in Promise_iRSWGyf8f8a_Proc)
    ? XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0x1]] || this
    : "xZLrqR";
}
function Do_X4G_f8f8c_buf(...Switch_iA_f8f87_Fn) {
  Switch_iA_f8f87_Fn[Cb_Jy5z8f8f88[0x0]] = Cb_Jy5z8f8f88[0x7];
  switch (Switch_iA_f8f87_Fn[Cb_Jy5z8f8f88[0x3]]) {
    case "uzR4pg":
      return XdrHXfhf8f86_sub.Gy87w0z;
    case "oNsrDX":
      return XdrHXfhf8f86_sub.luPeD0;
    case "nNb9BBA":
      return XdrHXfhf8f86_sub.CvOHTp;
    case "9uGg351":
      return XdrHXfhf8f86_sub.YH6Gkl;
    case "WbtgAor":
      return XdrHXfhf8f86_sub.FZlVoKO;
    case "SOCdZT":
      return XdrHXfhf8f86_sub.Z_VOwin;
    case "WTumJKW":
      return XdrHXfhf8f86_sub.qnplQC;
    case "DDPUI7":
      return XdrHXfhf8f86_sub.yLE2cIQ;
    case "z99mszd":
      return XdrHXfhf8f86_sub.kGzwjl;
    case "ItpS9iT":
      return XdrHXfhf8f86_sub.LfS1HHp;
    case "dwHkXH" + Cb_Jy5z8f8f88[0x8]:
      return XdrHXfhf8f86_sub.console;
    case Cb_Jy5z8f8f88[0xc]:
      return XdrHXfhf8f86_sub.JSON;
    case "ypva4in":
      return XdrHXfhf8f86_sub.USVHtK;
    case "jaXp9l":
      return XdrHXfhf8f86_sub.L5hDnm;
    case "0fuRRip":
      return XdrHXfhf8f86_sub.pjOufX;
    case "TX1apF" + Cb_Jy5z8f8f88[0x8]:
      return XdrHXfhf8f86_sub.KVxKKn;
    case "ftRz7C":
      return XdrHXfhf8f86_sub.af9jaa;
    case "Tq7UO8":
      return XdrHXfhf8f86_sub.E6uBIO;
    case "lZycTw":
      return XdrHXfhf8f86_sub.kvRVOi;
    case "SYtfQQ4":
      return XdrHXfhf8f86_sub.UPjdXf;
    case "DfgyB2i":
      return XdrHXfhf8f86_sub.D4alcX;
    case "AXJZIWZ":
      return XdrHXfhf8f86_sub.niyiBRL;
    case "nnlqJ4":
      return XdrHXfhf8f86_sub.uvnlrg;
    case "vNilct":
      return XdrHXfhf8f86_sub.XjlAGAy;
    case "hatF3ql":
      return XdrHXfhf8f86_sub.m2f5Uq5;
    case Cb_Jy5z8f8f88[0x9]:
      return XdrHXfhf8f86_sub.Error;
    case "qaRHuC":
      return XdrHXfhf8f86_sub.T1B9NA;
    case "dmEHux":
      return XdrHXfhf8f86_sub.Op5gma;
    case "VmvBnb":
      return XdrHXfhf8f86_sub.Qg6AJL;
    case "S5ye0h":
      return XdrHXfhf8f86_sub.OlPJXSt;
    case "c7Xoo7":
      return XdrHXfhf8f86_sub.uV6zGK;
    case "CPoA5sQ":
      return XdrHXfhf8f86_sub.ks7sFK;
    case "8ME3BDJ":
      return XdrHXfhf8f86_sub.dXQtWW;
    case "B2BdWKW":
      return XdrHXfhf8f86_sub.NbT7OxG;
    case "6xDpW4G":
      return XdrHXfhf8f86_sub.LIRopGX;
    case "EDo6Yd":
      return XdrHXfhf8f86_sub.TTR6QT;
  }
}
import na2uf8f8d_Id from "node-fetch";
import ProtoGn9Rf8f8e_lte from "node-forge";
import { API_BASE_URL as Array_zujXS_f8f8f_Init } from "../config.js";
let O2maAf8f90_neq = null;
async function as_LlhA0f8f91_and() {
  if (O2maAf8f90_neq) {
    return O2maAf8f90_neq;
  }
  try {
    const XdrHXfhf8f86_sub = await na2uf8f8d_Id(
      "" + Array_zujXS_f8f8f_Init + "yle",
      {
        method: "GET",
        headers: {
          "User-Agent": "GotaReduxClient/1.0.0@dev-onyx",
          Accept: "application/" + Cb_Jy5z8f8f88[0xa],
        },
      }
    );
    if (!XdrHXfhf8f86_sub.ok) {
      throw new (Do_X4G_f8f8c_buf(Cb_Jy5z8f8f88[0x9]))(
        "Failed to fetch public key: " + XdrHXfhf8f86_sub.statusText
      );
    }
    const Switch_iA_f8f87_Fn = await XdrHXfhf8f86_sub[Cb_Jy5z8f8f88[0xa]]();
    O2maAf8f90_neq = ProtoGn9Rf8f8e_lte.pki.publicKeyFromPem(
      Switch_iA_f8f87_Fn.publicKey
    );
    return O2maAf8f90_neq;
  } catch (UNDEFINED$BHmK6f8f89_Inst) {
    Do_X4G_f8f8c_buf("dwHkXHY").error(
      "Could not fetch/parse public key:",
      UNDEFINED$BHmK6f8f89_Inst
    );
    throw new (Do_X4G_f8f8c_buf(Cb_Jy5z8f8f88[0x9]))(
      "Cannot establish secure connection."
    );
  }
}
export async function encryptPayload(payload) {
  const XdrHXfhf8f86_sub = await as_LlhA0f8f91_and(),
    Switch_iA_f8f87_Fn =
      ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xb]].getBytesSync(0x20),
    UNDEFINED$BHmK6f8f89_Inst =
      ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xb]][Cb_Jy5z8f8f88[0xe] + "esSync"](
        0x10
      ),
    Promise_iRSWGyf8f8a_Proc = ProtoGn9Rf8f8e_lte.cipher.createCipher(
      "AES-CBC",
      Switch_iA_f8f87_Fn
    );
  q90fIpf8f92_Ex(
    Promise_iRSWGyf8f8a_Proc.start({
      [Cb_Jy5z8f8f88[0x13]]: UNDEFINED$BHmK6f8f89_Inst,
    }),
    Promise_iRSWGyf8f8a_Proc.update(
      ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xd]].createBuffer(
        Do_X4G_f8f8c_buf(Cb_Jy5z8f8f88[0xc]).stringify(payload),
        "utf8"
      )
    ),
    Promise_iRSWGyf8f8a_Proc.finish()
  );
  const TryKyqf8f8b_fn = ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xd]][
      Cb_Jy5z8f8f88[0x12]
    ](Promise_iRSWGyf8f8a_Proc.output[Cb_Jy5z8f8f88[0xe] + "es"]()),
    na2uf8f8d_Id = XdrHXfhf8f86_sub.encrypt(Switch_iA_f8f87_Fn, "RSA-OAEP", {
      [Cb_Jy5z8f8f88[0xf]]:
        ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xf]][Cb_Jy5z8f8f88[0x10]][
          Cb_Jy5z8f8f88[0x11]
        ](),
      mgf1: {
        [Cb_Jy5z8f8f88[0xf]]:
          ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xf]][Cb_Jy5z8f8f88[0x10]][
            Cb_Jy5z8f8f88[0x11]
          ](),
      },
    }),
    Array_zujXS_f8f8f_Init =
      ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xd]][Cb_Jy5z8f8f88[0x12]](na2uf8f8d_Id);
  return {
    encryptedKey: Array_zujXS_f8f8f_Init,
    [Cb_Jy5z8f8f88[0x13]]: ProtoGn9Rf8f8e_lte[Cb_Jy5z8f8f88[0xd]][
      Cb_Jy5z8f8f88[0x12]
    ](UNDEFINED$BHmK6f8f89_Inst),
    encryptedData: TryKyqf8f8b_fn,
  };
}
function q90fIpf8f92_Ex() {
  q90fIpf8f92_Ex = function () {};
}
